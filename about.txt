===============================================================================================
                TVSources  v3 (нужен Simple TV v.0.5.x ).    
                 / Multilanguage (ru,en,de,ua,vn,pt) /
===============================================================================================
/ дополнение является продолжением TVSources v1.102, разработанного Dmitry R. /

===============================================================================================
ОПИСАНИЕ:	
	TVSources - это дополнение позволяющее управление вашими источниками и плейлистами, 
	осуществлять сортировку и фильтрацию источников, плейлистов и каналов ТВ.
	Так же TVSources позволяет объединить все источники в один плейлист и осуществлять быстрое переключение между ними. 
	То есть в плейлисте присутствует один канал с одним названием, но с разных источников. 
	Вы в любой момент можете переключить источник не меняя плейлист. Просто включаете канал, 
	например 'Первый канал', нажимаете сочетание клавиш Shift+T, и на экране видите список источников, 
	которые доступны для этого канала. 
	При отсутствии связи с источником, TVSources автоматически переключается на следующий.
	
Настройки дополнения производятся в окне Настройки / ctrl+O - дополнения - "ТВ Источники" /
===============================================================================================

Поддерживаются источники:
- AceStream: AceSearch, TorrentTV или другие по этой технологии
- IPTV: любые ваши источники, а также Zabava (RT), PeersTV, TV+ и многие другие, для которых есть скрапер (скрипт для обработки)
- при использовании дополнения Timeshift для некоторых провайдеров IPTV доступен архив.

Все обновления можно скачать из репозитория: http://www.mediafire.com/folder/y4aqacseb5zee/TVSources3
===============================================================================================
Перед первой установкой удалите или переименуйте старую папку \user\TVSources

УСТАНОВКА:	

	Все архивы устанавливаются путем распаковки в корне программы SimpleTV  (в папку \luaScr\user\TVSources\ )
	Если есть скраперы вида xxxxx_pls.lua, то они для первой установки копируются в папку \luaScr\user\TVSources\AutoSetup\ .	 
	Если вы в первый раз устанавливаете TVSources, то разверните архив с фильтрами TVS_filters_Default.zip 
    Логотипы источников можно взять в репозитории в Icons.zip
	-----------------
	После запуска SimpleTV источники активируются и их можно найти в настройках 
	После запуска обновите источники кнопкой с зеленой круговой стрелкой "Обновить плейлист", 
		или через меню ctrl+shift+N - каждый источник по отдельности,
		или через контекстное меню ПКМ на фильтре - дополнительно - TVS: обночить источник


Периодически обновляйте источники.
===============================================================================================

Отличия в этой версии:
----------------------
{пользователям}:
- все используемые файлы дополнения имеют кодировку utf-8 (без bom метки)
  / исходники скриптов, файлы настроек, файлы фильтров и групп/
- поддерживает загрузку .m3u и .m3u8 плейлистов в кодировках ansi (plain text), utf-8 и unicode
  /для загрузки плейлиста в кодировке ansi, отличной от win-1251, необходимо скрапером,
   либо вручную, преобразовать исходный плейлист в utf-8 и использовать его /
- не зависит от установленной системной локали
- оптимизирован процесс актуализации каналов перед обработкой и записью в TVS (доли сек. - поэтому незаметен)
- можно загружать плейлисты без скрапера (будет искать плейлист в \TVSources\m3u\)
- все загружаемые плейлисты проходят группировку и обработку фильтрами, указанную в настройках,
  при загрузке и в базу SimpleTV и в файлы TVSources.
- поддерживаются .m3u8 плейлисты IPTV в своем формате имеющие строку для группы #EXTGRP после #EXTINF 
- скраперы не только устанавливаются, но и обновляются без дублирования источников в TVS, путем выкладывания в папку \AutoSetup\
- в настройках введена задержка сообщений обработки (10..100ms), в результате происходит прерывание долгой работы lua,
  что приводит к меньшей вероятности вылета программы 
- окно проигрывателя не замирает при длительной обработке, по причине указанной выше.

* поле "Скрапер" заполняется автоматически при установке скрапера;
* пояснения по использованию поля "Путь" в настройках источников:
 а) если поле "Скрапер" установлено, то здесь указывается файл m3u, в который будет выведен результат работы скрапера,
    (для этого случая и был когда-то определен флаг "удалять m3u после обработки" )
    
 б) если поле "Скрапер" не установлено, то здесь указывается файл m3u, который может быть загружен по url из интернета,
    либо из локального файла (папка для поиска файла \TVSources\m3u\);
    результат работы будет выведен во временный файл "xxxx_tmp.m3u"
    (флаг "удалять m3u после обработки" будет удалять именно его, а не файл указанный в "Пути")
 
{разработяикам}:

-  Вся работа по написанию своего скрапера сводится к нескольким пунктам. 
		 1. загрузка плейлиста
		 2. получение таблицы - t_pls = tvs_core.GetPlsAsTable(answer)
		 3. Какая-то нужная разработчику обработка
		 4. прогон таблицы фильтрами - m3ustr = tvs_core.ProcessFilterTable(UpdateID,Source,t_pls)
		 5. и, далее, вывод готового плейлиста в локальный m3u файл для передачи в ядро TVS.
		 Обязательны к определению 3 функции: GetSettings(), GetVersion(), GetList(UpdateID, m3u_file)
		 GetVersion() к тому же должна возвращать признак utf8
 
  Используете шаблон template_pls, и меняете код  внутри функции GetList().

 ---------------------------------------------------------------------------
Используемые горячие клавиши:
Ctrl+shift+N - обновить плейлист источника
Shift+T - сменить источник воспроизведения
----------------------------------------------------------------------------

Добавлено:
+ ведется лог добавленных каналов ( папка \log\ )
+ язык интерфейса TVS можно сделать соответствующим языку установленному в SimpleTV, для этого выберите в
  настройках TVS: Language->default 
+ настройка времени ожидания до смены источника, в секундах, по умолчанию стоит 15 сек.
+ сохранение меток избранных каналов и их восстановление (в закладке "Действия")
+ шаблон скрапера template_pls.lua - для подключения своих источников или для разработки скраперов..
+ сортировка в источниках теперь в соответствии с полем "Префикс для сортировки" (для удобства ставьте в этом поле двухзначный номер типа "01,02,03,04...")
  в этоим же порядке источники обновляются, и такой же порядок действует при автосмене источника.
 
 ---  MEDIA-SERVER  -------------------------------------------------------------------- 
  Добавлен медиа-сервер для стриминга потоков через SimpleTV в локальную сеть. 
  Основная цель -  воспроизведение зашифрованных потоков, если SimpleTV может их дешифровать, на других устройствах, которые сами не могут этого  сделать.
  
  Примеры запуска медиа-сервера: 
  1) с назначением IP и Port по умолчанию, скрипт сам попробует это сделать.
tv.exe -nooneinstance -execute "loadfile(m_simpleTV.MainScriptDir .. 'user/TVSources/srvr.lua')()" 
  2) с указанием IP этого компьютера и Port вручную:
tv.exe -nooneinstance -execute "loadfile(m_simpleTV.MainScriptDir .. 'user/TVSources/srvr.lua')('192.168.0.100:9090')" 
     также передавать параметры можно в старой редакции - ('192.168.0.100','9090') 
   
После запуска, откройте браузер по адресу http://192.168.xxx.xxx:9090/ и там найдёте ссылки на обычные m3u-файлы,
 которые можно открыть на других устройствах в локальной сети. А так же xml-файлы телепрограммы, подготовленные в SimpleTV.
 
---------------------------------------------------------------------------
!!! Перенос в другую версию SimpleTV 0.5.x:
---------------------------------------------------------------------------
	Файлы источников и фильтры копируем из  \TVSources\core\  :
		sources.lua
		channel_group.lua
		channel_filter.lua
		groups_filter.lua
	базы копируем из \work\tvs.db
	настройки копируем из \work\LuaConfig\TVS.ini

-------
! Переносим избранные из старой версии в новую:
- в старой версии в настройках [дополнение tvsources->действия] нажимаем кнопку "Export"
- копируем файл tvs_favorites.txt из папки \TVSources\core\ в новую версию по такому же пути
- в новой версии в настройках [дополнение tvsources->действия] нажимаем кнопку "Import"

*	Файл tvs_favorites.txt удобно использовать для сортировки избранного, простым копированием строк.
	Также удобно заполнить этот файл избыточно всеми возможными любимыми каналами, 
	теми которых пока нет, и затем путем импорта восполнить в базе.
 